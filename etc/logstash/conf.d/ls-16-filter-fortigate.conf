filter {
  if "firewall" in [tags] {
    grok {
      match => { "message" => "<%{NUMBER:syslog_index}>date=%{YEAR:year}\-%{MONTHNUM:month}\-%{MONTHDAY:day} time=%{TIME:time} devname=(\")?%{USERNAME:hostname}(\")? devid=(\")?%{USERNAME:devid}(\")? logid=(\")?%{NUMBER:logid}(\")? type=(\")?%{WORD:type}(\")? subtype=(\")?%{DATA:subtype}(\")? level=(\")?%{WORD:level}(\")? vd=(\")?%{WORD:vdom}(\")? eventtime=(\")?%{INT:eventtime}(\")? srcip=(\")?%{IP:source_ip}(\")?( srcport=(\")?%{INT:srcport}(\")? srcintf=(\")?%{GREEDYDATA:srcintf}(\")? srcintfrole=(\")?%{NOTSPACE:srcintfrole}(\")? dstip=(\")?%{IP:dstip}(\")? dstport=(\")?%{INT:dstport}(\")? dstintf=(\")?%{NOTSPACE:dstintf}(\")? dstintfrole=(\")?%{NOTSPACE:dstintfrole}(\")? poluuid=(\")?%{NOTSPACE:poluuid}(\")? sessionid=(\")?%{NOTSPACE:sessionid}(\")? proto=(\")?%{NOTSPACE:proto}(\")? action=(\")?%{NOTSPACE:action}(\")? policyid=(\")?%{NOTSPACE:policyid}(\")? policytype=(\")?%{NOTSPACE:policytype}(\")? service=(\")?%{NOTSPACE:service}(\")? dstcountry=%{QUOTEDSTRING:dstcountry} srccountry=%{QUOTEDSTRING:srccountry} trandisp=(\")?%{NOTSPACE:trandisp}(\")? appcat=(\")?%{NOTSPACE:appcat}(\")? applist=(\")?%{NOTSPACE:applist}(\")? duration=(\")?%{INT:duration}(\")? sentbyte=(\")?%{INT:sentbyte}(\")? rcvdbyte=(\")?%{INT:rcvdbyte}(\")? sentpkt=(\")?%{INT:sentpkt}(\")? rcvdpkt=(\")?%{INT:rcvdpkt}(\")? wanin=(\")?%{INT:wanin}(\")? wanout=(\")?%{INT:wanout}(\")? lanin=(\")?%{INT:lanin}(\")? lanout=(\")?%{INT:lanout}(\")? dstdevtype=(\")?%{GREEDYDATA:dstdevtype}(\")? masterdstmac=(\")?%{NOTSPACE:masterdstmac}(\")? dstmac=(\")?%{NOTSPACE:dstmac}(\")? dstserver=(\")?%{INT:dstserver}(\")?)?( srcintf=(\")?%{GREEDYDATA:srcintf}(\")? srcintfrole=(\")?%{NOTSPACE:srcintfrole}(\")? dstip=(\")?%{IP:dstip}(\")? dstintf=(\")?%{NOTSPACE:dstintf}(\")? dstintfrole=(\")?%{NOTSPACE:dstintfrole}(\")? poluuid=(\")?%{NOTSPACE:poluuid}(\")? sessionid=(\")?%{NOTSPACE:sessionid}(\")? proto=(\")?%{NOTSPACE:proto}(\")? action=(\")?%{NOTSPACE:action}(\")? policyid=(\")?%{NOTSPACE:policyid}(\")? policytype=(\")?%{NOTSPACE:policytype}(\")? service=(\")?%{NOTSPACE:service}(\")? dstcountry=%{QUOTEDSTRING:dstcountry} srccountry=%{QUOTEDSTRING:srccountry} trandisp=(\")?%{NOTSPACE:trandisp}(\")? duration=(\")?%{INT:duration}(\")? sentbyte=(\")?%{INT:sentbyte}(\")? rcvdbyte=(\")?%{INT:rcvdbyte}(\")? sentpkt=(\")?%{INT:sentpkt}(\")? rcvdpkt=(\")?%{INT:rcvdpkt}(\")? appcat=(\")?%{NOTSPACE:appcat}(\")? dstdevtype=(\")?%{GREEDYDATA:dstdevtype}(\")? masterdstmac=(\")?%{NOTSPACE:masterdstmac}(\")? dstmac=(\")?%{NOTSPACE:dstmac}(\")? dstserver=(\")?%{INT:dstserver}(\")?)?( srcport=(\")?%{INT:srcport}(\")? srcintf=(\")?%{GREEDYDATA:srcintf}(\")? srcintfrole=(\")?%{NOTSPACE:srcintfrole}(\")? dstip=(\")?%{IP:dstip}(\")? dstport=(\")?%{INT:dstport}(\")? dstintf=(\")?%{NOTSPACE:dstintf}(\")? dstintfrole=(\")?%{NOTSPACE:dstintfrole}(\")? poluuid=(\")?%{NOTSPACE:poluuid}(\")? sessionid=(\")?%{NOTSPACE:sessionid}(\")? proto=(\")?%{NOTSPACE:proto}(\")? action=(\")?%{NOTSPACE:action}(\")? policyid=(\")?%{NOTSPACE:policyid}(\")? policytype=(\")?%{NOTSPACE:policytype}(\")? service=(\")?%{NOTSPACE:service}(\")? dstcountry=%{QUOTEDSTRING:dstcountry} srccountry=%{QUOTEDSTRING:srccountry} trandisp=(\")?%{NOTSPACE:trandisp}(\")? transip=(\")?%{IP:transip}(\")? transport=(\")?%{INT:transport}(\")? duration=(\")?%{INT:duration}(\")? sentbyte=(\")?%{INT:sentbyte}(\")? rcvdbyte=(\")?%{INT:rcvdbyte}(\")? sentpkt=(\")?%{INT:sentpkt}(\")? rcvdpkt=(\")?%{INT:rcvdpkt}(\")? appcat=(\")?%{NOTSPACE:appcat}(\")?)?( srcport=(\")?%{INT:srcport}(\")? srcintf=(\")?%{GREEDYDATA:srcintf}(\")? srcintfrole=(\")?%{NOTSPACE:srcintfrole}(\")? dstip=(\")?%{IP:dstip}(\")? dstport=(\")?%{INT:dstport}(\")? dstintf=(\")?%{NOTSPACE:dstintf}(\")? dstintfrole=(\")?%{NOTSPACE:dstintfrole}(\")? poluuid=(\")?%{NOTSPACE:poluuid}(\")? sessionid=(\")?%{NOTSPACE:sessionid}(\")? proto=(\")?%{NOTSPACE:proto}(\")? action=(\")?%{NOTSPACE:action}(\")? policyid=(\")?%{NOTSPACE:policyid}(\")? policytype=(\")?%{NOTSPACE:policytype}(\")? service=(\")?%{NOTSPACE:service}(\")? dstcountry=%{QUOTEDSTRING:dstcountry} srccountry=%{QUOTEDSTRING:srccountry} trandisp=(\")?%{NOTSPACE:trandisp}(\")? appcat=(\")?%{NOTSPACE:appcat}(\")? applist=(\")?%{NOTSPACE:applist}(\")? duration=(\")?%{INT:duration}(\")? sentbyte=(\")?%{INT:sentbyte}(\")? rcvdbyte=(\")?%{INT:rcvdbyte}(\")? sentpkt=(\")?%{INT:sentpkt}(\")? rcvdpkt=(\")?%{INT:rcvdpkt}(\")? dstdevtype=(\")?%{GREEDYDATA:dstdevtype}(\")? masterdstmac=(\")?%{NOTSPACE:masterdstmac}(\")? dstmac=(\")?%{NOTSPACE:dstmac}(\")? dstserver=(\")?%{INT:dstserver}(\")?)?" }

    }
  }
}
